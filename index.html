<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Socolor Designer by ThangTran</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/chroma-js/2.4.2/chroma.min.js"></script>
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Be+Vietnam+Pro:ital,wght@0,300;0,400;0,600;0,700;0,900;1,400&family=Playfair+Display:ital,wght@0,400;0,700;1,400&family=Montserrat:wght@300;400;700;900&family=Dancing+Script:wght@700&family=Great+Vibes&family=Prata&family=Oswald:wght@500;700&family=Patrick+Hand&family=Anton&display=swap" rel="stylesheet">

    <style>
        body { font-family: 'Be Vietnam Pro', sans-serif; }
        .transition-all { transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1); }

        /* Nút chọn hướng */
        .direction-btn.active {
            background-color: #ffffff;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
            border-color: #6366f1;
            color: #4f46e5;
            transform: translateY(-2px);
        }
        .direction-btn.active svg { stroke: #4f46e5; stroke-width: 2.5; }

        /* Style Card chọn font */
        .style-card { transition: all 0.2s; border: 2px solid transparent; }
        .style-card:hover { transform: translateY(-2px); }
        .style-card.active { border-color: #4f46e5; background-color: #eef2ff; box-shadow: 0 4px 12px rgba(79, 70, 229, 0.15); }

        /* BACKGROUND ĐỘNG */
        .aurora-bg {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: -1;
            background: #fff;
            overflow: hidden;
        }
        .blob {
            position: absolute; 
            width: 130vw; 
            height: 130vw; 
            border-radius: 50%;
            filter: blur(80px); 
            opacity: 0.5; 
            animation: float 10s infinite ease-in-out alternate;
        }
        @keyframes float { from { transform: translate(0, 0) scale(1); } to { transform: translate(30px, -30px) scale(1.1); } }

        /* Glassmorphism */
        .glass {
            background: rgba(255, 255, 255, 0.7);
            backdrop-filter: blur(12px);
            -webkit-backdrop-filter: blur(12px);
            border: 1px solid rgba(255, 255, 255, 0.5);
        }

        /* Gradient Text cho Logo */
        .text-gradient {
            background-clip: text;
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-image: linear-gradient(to right, #333, #666);
        }

        /* Shadow giúp chữ nổi trên nền sặc sỡ */
        .text-shadow-sm { text-shadow: 0 1px 2px rgba(0,0,0,0.1); }
        .text-shadow-md { text-shadow: 0 2px 4px rgba(0,0,0,0.2); }
        .text-shadow-lg { text-shadow: 0 4px 8px rgba(0,0,0,0.3); }

        /* FONT CLASSES */
        .f-script { font-family: 'Great Vibes', cursive; }
        .f-hand { font-family: 'Patrick Hand', cursive; }
        .f-serif-display { font-family: 'Prata', serif; }
        .f-serif-text { font-family: 'Playfair Display', serif; }
        .f-sans-geo { font-family: 'Montserrat', sans-serif; }
        .f-sans-human { font-family: 'Be Vietnam Pro', sans-serif; }
        .f-condensed { font-family: 'Oswald', sans-serif; }
        .f-poster { font-family: 'Anton', sans-serif; } 
    </style>
</head>
<body class="text-slate-800 min-h-screen pb-48 relative">

    <div class="aurora-bg">
        <div id="blob1" class="blob bg-blue-100 top-[-20%] left-[-20%]"></div>
        <div id="blob2" class="blob bg-indigo-100 bottom-[-20%] right-[-20%] animation-delay-2000"></div>
    </div>

    <div class="sticky top-0 z-40 glass shadow-sm mb-10">
        <div class="max-w-5xl mx-auto px-4 py-4 flex justify-between items-center">
            <div>
                <h1 id="appLogo" class="text-2xl md:text-3xl font-extrabold tracking-tight text-gradient">
                    Socolor Designer
                </h1>
                <p class="text-xs text-slate-500 font-medium">by ThangTran</p>
            </div>
        </div>
    </div>

    <div class="max-w-5xl mx-auto px-4 space-y-16 relative z-10">

        <div class="bg-white/80 p-8 rounded-[2rem] shadow-xl border border-white backdrop-blur-sm relative">
            
            <h3 class="text-xs font-bold text-slate-400 uppercase tracking-wider mb-6 text-center">1. Chọn màu thương hiệu</h3>
            
            <div class="flex flex-col md:flex-row items-center justify-center gap-6">
                <div class="relative group">
                    <input type="color" id="colorPicker" value="#3282E3" 
                           class="w-24 h-24 rounded-full cursor-pointer border-4 border-white shadow-2xl p-0 overflow-hidden transition-transform transform group-hover:scale-110">
                </div>

                <div class="flex flex-col gap-2 w-full md:w-auto">
                    <div class="flex items-center gap-2">
                        <div class="flex-1 flex items-center border-2 border-slate-200 rounded-2xl overflow-hidden focus-within:border-blue-500 focus-within:ring-4 focus-within:ring-blue-100 transition-all bg-white h-12">
                            <span class="pl-4 text-slate-400 font-bold select-none">#</span>
                            <input type="text" id="textInput" value="3282E3"
                                   class="w-28 py-2 px-2 outline-none font-mono font-bold text-lg text-slate-700 uppercase bg-transparent placeholder-slate-300" 
                                   placeholder="3282E3">
                        </div>

                        <button onclick="randomColor()" class="h-12 px-4 rounded-2xl border-2 border-slate-200 bg-white text-slate-600 hover:border-indigo-400 hover:text-indigo-600 hover:shadow-md transition-all active:scale-95 flex items-center gap-2 font-bold text-xs tracking-wide">
                            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" class="w-4 h-4">
                                <path stroke-linecap="round" stroke-linejoin="round" d="M19.5 12c0-1.232-.046-2.453-.138-3.662a4.006 4.006 0 00-3.7-3.7 48.678 48.678 0 00-7.324 0 4.006 4.006 0 00-3.7 3.7c-.017.22-.032.441-.046.662M19.5 12l3-3m-3 3l-3-3m-12 3c0 1.232.046 2.453.138 3.662a4.006 4.006 0 003.7 3.7 48.656 48.656 0 007.324 0 4.006 4.006 0 003.7-3.7c.017-.22.032-.441.046-.662M4.5 12l3 3m-3-3l-3 3" />
                            </svg>
                            RANDOM
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <section>
            <div class="mb-6 border-l-4 border-slate-800 pl-4">
                <h3 class="text-xl font-bold text-slate-800 flex items-center gap-2">Bảng màu (Palette)</h3>
            </div>
            <div class="grid grid-cols-2 md:grid-cols-4 gap-4" id="spotPaletteContainer"></div>
        </section>

        <section class="border-t border-slate-200/60 pt-10">
            <div class="mb-8 border-l-4 border-indigo-500 pl-4">
                <h3 class="text-xl font-bold text-slate-800 flex items-center gap-2">Dải màu (Gradients)</h3>
            </div>
            <div class="mb-16">
                <div class="mb-4 flex justify-between items-center">
                    <h4 class="font-bold text-slate-700 text-lg">Generic Gradient <span class="text-[10px] bg-white/50 border border-slate-200 px-2 py-1 rounded text-slate-500">HERO</span></h4>
                    <button onclick="copyCSSGradient('generic')" class="text-xs font-bold text-white bg-slate-800 px-4 py-2 rounded-lg shadow hover:bg-slate-900">Copy CSS</button>
                </div>
                <div id="genericSmooth" class="h-20 w-full rounded-2xl mb-2 shadow-md border border-white transition-all duration-500"></div>
                <div class="grid grid-cols-3 md:grid-cols-6 gap-2" id="genericContainer"></div>
            </div>
            <div class="mb-4">
                <div class="mb-4 flex justify-between items-center">
                    <h4 class="font-bold text-slate-700 text-lg">Matching Gradient <span class="text-[10px] bg-white/50 border border-slate-200 px-2 py-1 rounded text-slate-500">ACCENT</span></h4>
                    <button onclick="copyCSSGradient('matching')" class="text-xs font-bold text-white bg-slate-800 px-4 py-2 rounded-lg shadow hover:bg-slate-900">Copy CSS</button>
                </div>
                <div id="matchingSmooth" class="h-20 w-full rounded-2xl mb-2 shadow-md border border-white transition-all duration-500"></div>
                <div class="grid grid-cols-3 md:grid-cols-6 gap-2" id="matchingContainer"></div>
            </div>
        </section>

        <section class="border-t-2 border-slate-200/60 pt-16 mt-16">
            <div class="mb-10 text-center">
                <span class="text-base font-bold tracking-widest text-indigo-500 uppercase mb-2 block">TEXT STUDIO</span>
                <h3 class="text-2xl sm:text-3xl font-extrabold text-slate-900 mb-2 leading-tight">Tăng tốc thời gian thiết kế</h3>
                <p class="text-slate-500 max-w-lg mx-auto">Không còn phải đau đầu chọn font, để hệ thống lo phần thẩm mỹ.</p>
            </div>

            <div class="grid grid-cols-1 lg:grid-cols-12 gap-10">
                
                <div class="lg:col-span-4 space-y-6">
                    <div class="bg-white/80 backdrop-blur p-6 rounded-2xl shadow-sm border border-white">
                        <label class="block text-xs font-bold text-slate-400 uppercase mb-4 tracking-wider">1. Nội dung</label>
                        <div class="space-y-3">
                            <textarea id="inputHeading" rows="2" class="w-full p-3 bg-slate-50 border border-slate-200 rounded-xl font-bold text-slate-800 focus:ring-2 focus:ring-indigo-500 outline-none resize-none transition-all focus:bg-white">Thanh Xuân</textarea>
                            <input type="text" id="inputSub" value="Như một chén trà" class="w-full p-3 bg-slate-50 border border-slate-200 rounded-xl text-sm focus:ring-2 focus:ring-indigo-500 outline-none transition-all focus:bg-white">
                            <textarea id="inputBody" rows="3" class="w-full p-3 bg-slate-50 border border-slate-200 rounded-xl text-xs focus:ring-2 focus:ring-indigo-500 outline-none resize-none transition-all focus:bg-white">Uống vào một phát hết bà thanh xuân.</textarea>
                        </div>
                    </div>

                    <div class="bg-white/80 backdrop-blur p-6 rounded-2xl shadow-sm border border-white">
                        <label class="block text-xs font-bold text-slate-400 uppercase mb-4 tracking-wider">2. Phong cách Font</label>
                        <div class="grid grid-cols-2 gap-3" id="styleSelector"></div>
                    </div>

                    <div class="bg-white/80 backdrop-blur p-6 rounded-2xl shadow-sm border border-white">
                        <label class="block text-xs font-bold text-slate-400 uppercase mb-4 tracking-wider">3. Bố cục</label>
                        <div class="flex gap-2">
                            <button onclick="setLayout('center')" id="layout-center" class="layout-btn flex-1 py-3 rounded-xl border border-slate-200 hover:bg-white text-xs font-bold active bg-white shadow-sm">Căn Giữa</button>
                            <button onclick="setLayout('left')" id="layout-left" class="layout-btn flex-1 py-3 rounded-xl border border-slate-200 hover:bg-white text-xs font-bold">Tạp Chí</button>
                            <button onclick="setLayout('poster')" id="layout-poster" class="layout-btn flex-1 py-3 rounded-xl border border-slate-200 hover:bg-white text-xs font-bold">Poster</button>
                        </div>
                    </div>
                </div>

                <div class="lg:col-span-8">
                    <div id="typoPreviewArea" class="sticky top-24 w-full aspect-[4/5] md:aspect-video rounded-[2.5rem] shadow-2xl border-4 border-white ring-1 ring-slate-200 relative overflow-hidden transition-all duration-500 flex flex-col justify-center items-center p-10 md:p-16 bg-white group">
                        
                        <div id="previewBg" class="absolute inset-0 z-0 transition-colors duration-500"></div>
                        <div id="decoShape1" class="absolute -top-20 -right-20 w-96 h-96 rounded-full mix-blend-multiply filter blur-3xl opacity-30 transition-colors duration-700 z-0"></div>
                        <div id="decoShape2" class="absolute -bottom-20 -left-20 w-80 h-80 rounded-full mix-blend-multiply filter blur-3xl opacity-30 transition-colors duration-700 z-0"></div>

                        <div class="absolute top-6 right-6 z-20 opacity-0 group-hover:opacity-100 transition-opacity duration-300">
                            <div class="glass px-4 py-2 rounded-lg text-[10px] text-slate-500 shadow-sm backdrop-blur-md bg-white/80">
                                <p>Heading: <span id="fontNameHead" class="font-bold text-slate-800">Font</span></p>
                                <p>Sub: <span id="fontNameSub" class="font-bold text-slate-800">Font</span></p>
                            </div>
                        </div>

                        <div id="contentContainer" class="relative z-10 text-center w-full max-w-2xl transition-all duration-500 flex flex-col">
                            </div>
                    </div>
                </div>

            </div>
        </section>

    </div>

    <footer class="text-center mt-10 text-slate-400 text-sm font-medium pb-20">&copy; 2025 Socolor Designer. Built by ThangTran.</footer>

    <div class="fixed bottom-6 left-4 right-4 z-50">
        <div class="glass p-3 rounded-2xl shadow-2xl border border-white/50 max-w-lg mx-auto flex items-center justify-between gap-4 bg-white/80">
            <div class="flex flex-col pl-2">
                <span class="text-xs font-bold text-slate-800">Hướng Gradient</span>
                <span class="text-[10px] text-slate-500">Chạm để đổi chiều</span>
            </div>
            <div class="flex gap-2">
                <button onclick="setDirection('to right')" id="dirRight" class="direction-btn w-10 h-10 rounded-xl border border-transparent bg-slate-100 flex items-center justify-center transition-all active:scale-95"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-5 h-5 text-slate-600"><path stroke-linecap="round" stroke-linejoin="round" d="M13.5 4.5L21 12m0 0l-7.5 7.5M21 12H3" /></svg></button>
                <button onclick="setDirection('to left')" id="dirLeft" class="direction-btn w-10 h-10 rounded-xl border border-transparent bg-slate-100 flex items-center justify-center transition-all active:scale-95"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-5 h-5 text-slate-600"><path stroke-linecap="round" stroke-linejoin="round" d="M10.5 19.5L3 12m0 0l7.5-7.5M3 12h18" /></svg></button>
                <button onclick="setDirection('to bottom right')" id="dirDiagonal" class="direction-btn w-10 h-10 rounded-xl border border-transparent bg-slate-100 flex items-center justify-center transition-all active:scale-95 active"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-5 h-5 text-slate-600"><path stroke-linecap="round" stroke-linejoin="round" d="M19.5 4.5l-15 15m0 0h11.25m-11.25 0V8.25" /></svg></button>
            </div>
        </div>
    </div>

    <div id="toast" class="fixed top-20 left-1/2 transform -translate-x-1/2 glass text-slate-800 px-6 py-3 rounded-full shadow-xl opacity-0 transition-all duration-300 pointer-events-none z-[60] font-bold flex items-center gap-2 text-sm translate-y-[-20px] border border-white/50">✅ Đã copy!</div>

    <script>
        let currentDirection = 'to bottom right'; 
        
        const styles = [
            { id: 'thanhxuan', name: 'Thanh Xuân', fontHead: 'f-script', nameHead: 'Great Vibes', fontSub: 'f-sans-geo', nameSub: 'Montserrat', fontBody: 'f-sans-human', isScript: true, subCase: 'uppercase tracking-widest', desc: 'Mềm mại, bay bổng' },
            { id: 'quocdan', name: 'Quốc Dân', fontHead: 'f-sans-human', nameHead: 'Be Vietnam Pro', fontSub: 'f-sans-human', nameSub: 'Be Vietnam Pro', fontBody: 'f-sans-human', isScript: false, subCase: 'uppercase tracking-wide', desc: 'Hiện đại, rõ ràng' },
            { id: 'tapchi', name: 'Tạp Chí', fontHead: 'f-serif-display', nameHead: 'Prata', fontSub: 'f-sans-geo', nameSub: 'Montserrat', fontBody: 'f-serif-text', isScript: false, subCase: 'italic tracking-wide', desc: 'Sang trọng, thời trang' },
            { id: 'ngonghinh', name: 'Ngộ Nghĩnh', fontHead: 'f-hand', nameHead: 'Patrick Hand', fontSub: 'f-hand', nameSub: 'Patrick Hand', fontBody: 'f-sans-human', isScript: false, subCase: 'lowercase tracking-wide', desc: 'Vui tươi, thân thiện' },
            { id: 'poster', name: 'Poster Phim', fontHead: 'f-poster', nameHead: 'Anton', fontSub: 'f-sans-geo', nameSub: 'Montserrat', fontBody: 'f-sans-human', isScript: false, subCase: 'uppercase tracking-tighter', desc: 'Mạnh mẽ, ấn tượng' },
            { id: 'tho', name: 'Thơ Ca', fontHead: 'f-serif-text', nameHead: 'Playfair', fontSub: 'f-script', nameSub: 'Great Vibes', fontBody: 'f-serif-text', isScript: true, subCase: 'normal-case text-lg', desc: 'Cổ điển, lãng mạn' }
        ];

        let currentStyle = styles[0];
        let currentLayout = 'center';

        // LOGIC MÀU SẮC
        function generateProPalettes(baseColor) {
            if (!chroma.valid(baseColor)) return null;
            const root = chroma(baseColor);
            const clampSat = (color, maxSat = 0.85) => color.get('hsl.s') > maxSat ? color.set('hsl.s', maxSat) : color;

            const genMid = clampSat(root.set('hsl.h', '-50').brighten(0.5)); 
            const genEnd = root.set('hsl.h', '-160').set('hsl.l', 0.92).set('hsl.s', 0.8);
            const genericScale = chroma.scale([root, genMid, genEnd]).mode('lch').colors(6);

            const matchMid = clampSat(root.set('hsl.h', '+60').brighten(0.3)); 
            const matchEnd = root.set('hsl.h', '+140').set('hsl.l', 0.75).set('hsl.s', 0.65);
            const matchingScale = chroma.scale([root, matchMid, matchEnd]).mode('lch').colors(6);

            const spotPalette = [
                root.hex(), 
                root.set('hsl.h', '+30').set('hsl.l', 0.65).hex(), 
                root.set('hsl.h', '+180').set('hsl.l', 0.92).set('hsl.s', 0.3).hex(), 
                root.set('hsl.h', '+15').darken(1.2).saturate(0.5).hex() 
            ];

            return { generic: genericScale, matching: matchingScale, spot: spotPalette };
        }

        function isLight(colorHex) { return chroma(colorHex).luminance() > 0.5; }
        function toTitleCase(str) { return str.toLowerCase().split(' ').map(w => w.charAt(0).toUpperCase() + w.slice(1)).join(' '); }
        function randomColor() { const randomHex = chroma.random().hex(); document.getElementById('colorPicker').value = randomHex; document.getElementById('textInput').value = randomHex.substring(1).toUpperCase(); updateUI(randomHex); }

        // UI HANDLING
        const colorPicker = document.getElementById('colorPicker');
        const textInput = document.getElementById('textInput');
        let currentPaletteData = null; 
        // MÃ MÀU CỐ ĐỊNH MỚI: #3282E3
        let currentColor = "#3282E3"; 
        
        initStyleSelector();
        updateUI(currentColor);

        colorPicker.addEventListener('input', (e) => { textInput.value = e.target.value.substring(1).toUpperCase(); updateUI(e.target.value); });
        textInput.addEventListener('input', (e) => {
            let rawVal = e.target.value.replace(/#/g, '').replace(/[^0-9A-Fa-f]/g, '');
            if (rawVal.length > 6) rawVal = rawVal.slice(0, 6);
            e.target.value = rawVal.toUpperCase();
            if (rawVal.length === 6 && chroma.valid("#" + rawVal)) { colorPicker.value = "#" + rawVal; updateUI("#" + rawVal); }
        });

        ['inputHeading', 'inputSub', 'inputBody'].forEach(id => document.getElementById(id).addEventListener('input', updateTypographyPreview));

        function setDirection(dir) {
            currentDirection = dir;
            document.querySelectorAll('.direction-btn').forEach(el => el.classList.remove('active'));
            let activeId = 'dirRight'; if (dir === 'to left') activeId = 'dirLeft'; if (dir === 'to bottom right') activeId = 'dirDiagonal';
            document.getElementById(activeId).classList.add('active');
            updateUI(currentColor);
        }

        function initStyleSelector() {
            const container = document.getElementById('styleSelector');
            container.innerHTML = '';
            styles.forEach(s => {
                const btn = document.createElement('button');
                btn.className = `style-card p-3 rounded-xl bg-slate-50 text-left w-full ${s.id === 'thanhxuan' ? 'active' : ''}`;
                btn.onclick = () => {
                    document.querySelectorAll('.style-card').forEach(el => el.classList.remove('active'));
                    btn.classList.add('active');
                    currentStyle = s;
                    updateTypographyPreview();
                };
                btn.innerHTML = `
                    <span class="block text-sm text-slate-800 ${s.fontHead}">${s.name}</span>
                    <span class="block text-sm text-slate-400 mt-1">${s.desc}</span>
                `;
                container.appendChild(btn);
            });
        }

        function setLayout(layout) {
            currentLayout = layout;
            document.querySelectorAll('.layout-btn').forEach(el => {
                el.classList.remove('active', 'bg-white', 'shadow-sm');
                el.classList.add('border-slate-200');
            });
            document.getElementById('layout-'+layout).classList.add('active', 'bg-white', 'shadow-sm');
            updateTypographyPreview();
        }

        function updateUI(color) {
            if (!chroma.valid(color)) return;
            currentColor = color;
            const data = generateProPalettes(color);
            currentPaletteData = data;

            // Update Aurora Bg
            document.getElementById('blob1').style.backgroundColor = data.generic[2];
            document.getElementById('blob2').style.backgroundColor = data.matching[2];

            // UPDATE LOGO GRADIENT
            const logo = document.getElementById('appLogo');
            const gradientText = `linear-gradient(to right, ${data.spot[0]}, ${data.matching[5]})`;
            logo.style.backgroundImage = gradientText;

            updateGradientSection('generic', data.generic);
            updateGradientSection('matching', data.matching);
            renderSpotPalette('spotPaletteContainer', data.spot);
            updateTypographyPreview();
        }

        function updateTypographyPreview() {
            if (!currentPaletteData) return;

            let hVal = document.getElementById('inputHeading').value;
            const sVal = document.getElementById('inputSub').value;
            const bVal = document.getElementById('inputBody').value;
            
            const container = document.getElementById('contentContainer');
            const previewBg = document.getElementById('previewBg');
            const bgShape1 = document.getElementById('decoShape1');
            const bgShape2 = document.getElementById('decoShape2');

            // Update Font Name Tag
            document.getElementById('fontNameHead').innerText = currentStyle.nameHead;
            document.getElementById('fontNameSub').innerText = currentStyle.nameSub;

            // Logic Script Case
            if (currentStyle.isScript) hVal = toTitleCase(hVal);

            container.innerHTML = ''; 
            container.className = "relative z-10 w-full max-w-2xl transition-all duration-500 flex flex-col h-full justify-center";

            const pHead = document.createElement('h1');
            const pSub = document.createElement('h3');
            const pBody = document.createElement('p');
            const pLine = document.createElement('div');

            pHead.innerText = hVal; pSub.innerText = sVal; pBody.innerText = bVal;

            // Thêm shadow cho text để nổi trên mọi nền
            const textShadowClass = currentLayout === 'poster' ? 'text-shadow-lg' : 'text-shadow-sm';

            pHead.className = `mb-4 leading-tight transition-all duration-300 text-smart-balance drop-shadow-sm ${textShadowClass} ${currentStyle.fontHead}`;
            
            if (currentStyle.id === 'poster') {
                pHead.classList.add('text-7xl', 'md:text-9xl', 'font-black', 'uppercase', 'tracking-tighter');
            } else if (currentStyle.id === 'thanhxuan') {
                pHead.classList.add('text-6xl', 'md:text-8xl', 'font-normal'); 
            } else {
                pHead.classList.add('text-5xl', 'md:text-7xl', 'font-bold');
                if (currentStyle.headCase === 'uppercase') pHead.classList.add('uppercase');
            }

            pSub.className = `mb-4 transition-all duration-300 text-sm font-bold ${currentStyle.fontSub} ${currentStyle.subCase}`;
            pBody.className = `text-base md:text-lg leading-relaxed max-w-lg mx-auto transition-all duration-300 opacity-90 ${currentStyle.fontBody}`;

            if (currentLayout === 'center') {
                container.classList.add('text-center', 'items-center');
                pLine.className = "w-16 h-1 rounded-full mx-auto mb-6 transition-all";
                container.appendChild(pSub); container.appendChild(pHead); container.appendChild(pLine); container.appendChild(pBody);
            } else if (currentLayout === 'left') {
                container.classList.add('text-left', 'items-start');
                pLine.className = "w-10 h-1 rounded-full mb-6 transition-all";
                container.appendChild(pLine); container.appendChild(pHead); container.appendChild(pSub); container.appendChild(pBody);
            } else if (currentLayout === 'poster') {
                container.classList.add('text-center', 'items-center');
                container.appendChild(pSub); container.appendChild(pHead); container.appendChild(pBody);
            }

            const primary = currentPaletteData.spot[0];
            const accent = currentPaletteData.spot[3];
            
            bgShape1.style.backgroundColor = currentPaletteData.generic[2];
            bgShape2.style.backgroundColor = currentPaletteData.matching[2];

            if (currentLayout === 'poster') {
                // LOGIC MỚI: OVERLAY LÀM DỊU NỀN
                const midColor = currentPaletteData.generic[2]; 
                const lightBg = isLight(midColor);
                
                // Chọn màu lớp phủ: Trắng mờ nếu nền sáng, Đen mờ nếu nền tối
                const overlayColor = lightBg ? 'rgba(255,255,255,0.4)' : 'rgba(0,0,0,0.3)';
                
                // Gradient nền = Lớp phủ + Gradient màu
                const gradientCSS = `linear-gradient(${currentDirection}, ${overlayColor}, ${overlayColor}), linear-gradient(${currentDirection}, ${currentPaletteData.generic.join(', ')})`;
                previewBg.style.background = gradientCSS;
                
                const textColor = lightBg ? '#0f172a' : '#ffffff';
                
                pHead.style.color = textColor;
                pSub.style.color = lightBg ? primary : '#fbbf24'; 
                pBody.style.color = lightBg ? '#334155' : 'rgba(255,255,255,0.9)';
                bgShape1.style.opacity = '0.1'; bgShape2.style.opacity = '0.1';

            } else {
                previewBg.style.background = '#ffffff';
                pHead.style.color = primary;
                pSub.style.color = accent;
                pBody.style.color = "#334155";
                pLine.style.backgroundColor = accent;
                bgShape1.style.opacity = '0.4'; bgShape2.style.opacity = '0.4';
            }
        }

        function updateGradientSection(type, colors) {
            const smoothEl = document.getElementById(type + 'Smooth');
            smoothEl.style.background = `linear-gradient(${currentDirection}, ${colors.join(', ')})`;
            const container = document.getElementById(type + 'Container');
            container.innerHTML = '';
            colors.forEach((hex, idx) => {
                const wrapper = document.createElement('div'); wrapper.className = "flex flex-col gap-1 group cursor-pointer"; wrapper.onclick = () => copyText(hex);
                const box = document.createElement('div'); 
                let roundedClass = "rounded-md"; if (idx === 0) roundedClass = "rounded-bl-2xl rounded-tr-md rounded-br-md"; if (idx === 5) roundedClass = "rounded-br-2xl rounded-tl-md rounded-bl-md";
                box.className = `h-16 ${roundedClass} shadow-sm transition-transform group-hover:-translate-y-1 border border-slate-100`; box.style.backgroundColor = hex;
                const label = document.createElement('span'); label.className = "text-[10px] text-center font-mono text-slate-400 font-bold uppercase group-hover:text-indigo-600 transition-colors"; label.innerText = hex;
                wrapper.appendChild(box); wrapper.appendChild(label); container.appendChild(wrapper);
            });
        }

        function renderSpotPalette(containerId, colors) {
            const container = document.getElementById(containerId);
            container.innerHTML = '';
            const labels = ["Primary", "Secondary", "Bg", "Accent"];
            colors.forEach((hex, index) => {
                const wrapper = document.createElement('div'); wrapper.className = "flex flex-col gap-2 group cursor-pointer"; wrapper.onclick = () => copyText(hex);
                const box = document.createElement('div'); box.className = "h-24 rounded-xl shadow-md transition-transform group-hover:-translate-y-1 border border-slate-100 relative"; box.style.backgroundColor = hex;
                box.innerHTML = `<div class="absolute inset-0 flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity"><span class="bg-black/20 text-white text-xs font-bold px-2 py-1 rounded-full backdrop-blur-sm">Copy</span></div>`;
                const textDiv = document.createElement('div'); textDiv.className = "text-center flex flex-col"; textDiv.innerHTML = `<span class="text-xs font-mono text-slate-600 font-bold uppercase">${hex}</span><span class="text-[10px] text-slate-400">${labels[index]}</span>`;
                wrapper.appendChild(box); wrapper.appendChild(textDiv); container.appendChild(wrapper);
            });
        }

        async function copyCSSGradient(type) { if (!currentPaletteData) return; const colors = type === 'generic' ? currentPaletteData.generic : currentPaletteData.matching; const css = `background-image: linear-gradient(${currentDirection}, ${colors.join(', ')});`; await copyText(css); }
        async function copyText(text) { try { await navigator.clipboard.writeText(text); showToast(text); } catch (err) { const ta = document.createElement("textarea"); ta.value = text; document.body.appendChild(ta); ta.select(); document.execCommand("copy"); document.body.removeChild(ta); showToast(text); } }
        function showToast(msg) { const toast = document.getElementById('toast'); toast.textContent = "✅ Đã copy: " + (msg.length > 20 ? 'CSS Code' : msg); toast.classList.remove('opacity-0'); toast.classList.remove('translate-y-[-20px]'); setTimeout(() => { toast.classList.add('opacity-0'); toast.classList.add('translate-y-[-20px]'); }, 2000); }
    </script>
</body>
</html>
